<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <title>Title</title>
</head>
<body>

</body>
</html>
<script>
let obj = {}
function defineReactive(data, key, val) {
	let dep = new Dep()
   Object.defineProperty(data, key, {
   	enumerable: true,
      configurable: true,
      get: function () {
   		console.log('get:'+val)
         dep.depend()
         return val
      },
      set: function (newVal) {
         if (val === newVal) {
         	return
         }
         val = newVal
	      console.log('set:'+val)
         dep.notify()
      }
   })
}
function remove(arr, item) {
   if (arr.length) {
   	const index = arr.indexOf(item)
      if (index > -1) {
   		return arr.splice(index, 1)
      }
   }
}
class Dep {
	constructor () {
		this.subs = []
   }
   addSub (sub) {
		this.subs.push(sub)
   }
   removeSub (sub) {
		remove(this.subs, sub)
   }
   depend () {
		if (window.target) {
			this.addSub(window.target)
      }
   }
   notify () {
		const subs = this.subs.slice()
      for (let i = 0, l = subs.length; i < 1; i++) {
			subs[i].update()
      }
   }
}

defineReactive(obj, 'aa', 0)
obj.aa = 1
console.log(obj.aa)
</script>
